<p class="breadcrumb">
  <%= link_to 'Home', root_path %> > <%= link_to 'Admin', admin_path %> > <%= @event.name %>
</p>

<h1 class="page-title"><span class="page-title-firstword">Details</span> for <%= @event.name %></h1>


<% unless @event.application_process == "application_by_organizer" %>
<section class="box">
  <h2 class="box-title">Applications</h2>
  <%= pluralize_highlight_count(@event.applications.submitted.count, "application") %> currently
  <br>
  <%= pluralize_highlight_count(@event.applications.drafts.count, "draft") %> currently
</section>
<% if @event.applications.submitted.any? %>
    <% @categorized_applications.each do |heading, applications| %>

      <div class="box">
        <h2><%= heading %> (<%= applications.count %>)</h2>

        <div class="admin">
          <ul class="admin-list">
            <% applications.each do |application| %>
              <li>
                <p class="event-name">
                  <span class="conflogo--small"><%= event_image application.event %></span>
                  <%= link_to application.name, event_application_path(application.event_id, application.id), title: application.event.name %>
                </p>
                <p>
                  <% if (application.status == "approved") || (application.status == "rejected") %>
                    <%= link_to undo_event_application_path(application.event_id, application.id),
                        method: :post, class: "icon tooltip",
                        title: 'undo' do %>
                        Undo
                      <% end %>
                  <% else %>
                    <%= link_to approve_event_application_path(application.event_id, application.id),
                        method: :post, class: "icon tooltip",
                        title: 'approve' do %>
                      <span class="approve-application-icon" aria-label="approve icon">&#x2714;</span>
                    <% end %>

                    <%= link_to reject_event_application_path(application.event_id, application.id),
                        method: :post, class: "icon tooltip",
                        title: 'reject' do %>
                      <span class="reject-application-icon" aria-label="reject icon">&#x2718;</span>
                    <% end %>
                  <% end %>

                  <%= link_to admin_event_application_path(application.id, application.event_id), method: :delete,
                      data: { confirm: "Are you sure?"}, class: "icon tooltip", title: "delete" do %>
                    <span class="icon-delete" aria-label="trashcan icon"></span>
                  <% end %>
                </p>
              </li>
            <% end %>
          </ul>
        </div>
      </div>
    <% end %>
  <% end %>
<% end %>

<div class="two-columns">
  <section class="box">
    <h2 class="box-title">Organizer Details</h2>
    <div class="detail-pair">
      <strong>Name</strong>
      <%= @event.organizer_name %>
    </div>
    <div class="detail-pair">
      <strong>Email</strong>
      <%= @event.organizer_email %>
    </div>
  </section>

  <%= render partial: "events/event" %>
</div>

<div class="form_field">
  <%= link_to "Edit event", edit_event_path(@event.id), class: "btn btn-edit" %>
  <%= link_to "Delete event", event_path(@event.id), method: :delete,
      data: {confirm: "Are you sure?"}, class: "btn btn-delete" %>
  <% unless @event.approved? %>
    <%= link_to "Approve event", approve_admin_event_path(@event.id), method: :post,
      class: "btn btn-save" %>
  <% end %>
</div>
